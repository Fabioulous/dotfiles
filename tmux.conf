# This file is inspired by several sources
#
# For the status bar section and some other settings:
# http://zanshin.net/2013/09/05/my-tmux-configuration/

#------------------
# General settings
#------------------

# use UTF8
set -g utf8
set-window-option -g utf8 on

# act like vim
# for more information about the vim mode see:
# http://blog.sanctum.geek.nz/vi-mode-in-tmux/
#setw -g mode-keys vi

# Set Ctrl-Space as the default prefix key-combinaison 
# and unbind C-b to free it up
set -g prefix C-Space
unbind C-b

# Allows to use C-Space-Space <command> to send commands to a TMUX session inside 
# another TMUX session
bind-key Space send-prefix

# Shorten command delay 
set -s escape-time 1

# Start windows and pane index at 1 (0 by default)
set -g base-index 1
setw -g pane-base-index 1

# reload ~/.tmux.conf using PREFIX r
bind r source-file ~/.tmux.conf \; display "Reloaded!"

# Allow scrolling with the mouse in panes
set -g mode-mouse on

# Visual bell instead of sound bell
set -g visual-bell on

#------------------
# Copy and Paste
#------------------
unbind [
unbind p
# Enter copy mode with <Esc>
bind Escape copy-mode
# select with v, yank to buffer with y, paste from buffer with p
bind p paste-buffer
bind-key -t vi-copy 'v' begin-selection
bind-key -t vi-copy 'y' copy-selection

#------------------
# Panes & windows
#------------------

bind c new-window -c "#{pane_current_path}"

# select panes with mouse
set -g mouse-select-pane on

# auto window rename
set-window-option -g automatic-rename

# input name at the creation of a new window
bind-key C command-prompt -p "Name of new window: " "new-window -n '%%'"

# use PREFIX ! to split window horizontally and PREFIX / to split vertically
bind ! split-window -h -c "#{pane_current_path}"
bind / split-window -v -c "#{pane_current_path}"

# use C-h and C-l to cycle thru windows
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# map Vi movement keys as pane movement keys
bind h select-pane -L 
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# resize panes like vim
bind LEFT   resize-pane -L 10
bind RIGHT  resize-pane -R 10
bind DOWN   resize-pane -D 10
bind UP     resize-pane -U 10

# change layout
bind n next-layout

# ----------------------
# Status Bar
# -----------------------
set-option -g status on                # turn the status bar on
set -g status-utf8 on                  # set utf-8 for the status bar
set -g status-interval 1               # set update frequencey
set -g status-justify centre           # center window list for clarity

# visual notification of activity in other windows
setw -g monitor-activity on
set -g visual-activity on

# show host name and IP address on left side of status bar
set -g status-left-length 30
set -g status-left '♪ #(exec amixer get Master | egrep -o "[0-9]+%" | egrep -o "[0-9]*") | ♥#(acpi | cut -d ',' -f 2) (#(acpi | cut -d " " -f 5 | cut -d ':' -f 1,2))'

# show session name, window & pane number, date and time on right side of status bar
set -g status-right "#S #I:#P [%d %b %Y-%H:%M:%S]"

# Current window appearance
set -g window-status-current-attr bold,reverse
# Other windows appearance
set -g window-status-activity-attr none

# ----------------------
# Colors
# ----------------------

# these lines allows to show the 256 colors
#for i in {0..255} ; do
    #printf "\x1b[38;5;${i}mcolour${i}\n"
#done

## colorscheme based on solarized
## default statusbar colors
#set-option -g status-bg colour31 #base2
#set-option -g status-fg colour130 #yellow
#set-option -g status-attr default
## default window title colors
#set-window-option -g window-status-fg colour180 #base00
#set-window-option -g window-status-bg default
##set-window-option -g window-status-attr dim
## active window title colors
#set-window-option -g window-status-current-fg colour21 #orange
#set-window-option -g window-status-current-bg colour81
## pane border
#set-option -g pane-border-fg colour231 #base2
#set-option -g pane-active-border-fg colour051 #base1
## message text
#set-option -g message-bg colour231 #base2
#set-option -g message-fg colour196 #orange
## pane number display
#set-option -g display-panes-active-colour colour20 #blue
#set-option -g display-panes-colour colour196 #orange
## clock
#set-window-option -g clock-mode-colour colour40 #green

# ----------------------
# Plugins
# ----------------------

# Remember to clone Tmux Plugin Manager
# git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm

# List of plugins
# Use <Prefix>+<S-i> to fetch plugins
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sidebar'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

# Colorize the output of tmux-sidebar
set -g @sidebar-tree-command 'tree -C'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
